<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Billing & Collections Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <style>
        :root {
            --primary: 221.2 83.2% 53.3%;
            --destructive: 0 84.2% 60.2%;
            --success: 142 76% 36%;
            --warning: 38 92% 50%;
            --info: 199 89% 48%;
            --muted: 220 14.3% 95.9%;
            --muted-foreground: 220 8.9% 46.1%;
            --border: 220 13% 91%;
            --card: 0 0% 100%;
            --foreground: 222.2 84% 4.9%;
            --background: 0 0% 100%;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background-color: hsl(var(--muted));
            color: hsl(var(--foreground));
        }

        .sidebar {
            width: 250px;
            background: hsl(var(--card));
            min-height: 100vh;
            position: fixed;
            left: 0;
            top: 0;
            border-right: 1px solid hsl(var(--border));
            padding: 1.5rem 0;
        }

        .main-content {
            margin-left: 250px;
            padding: 2rem;
        }

        .stat-card {
            background: hsl(var(--card));
            border: 1px solid hsl(var(--border));
            border-radius: 0.75rem;
            padding: 1.5rem;
            transition: box-shadow 0.2s;
        }

        .stat-card:hover {
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            color: hsl(var(--foreground));
        }

        .stat-label {
            font-size: 0.875rem;
            color: hsl(var(--muted-foreground));
            margin-bottom: 0.5rem;
        }

        .badge-success {
            background-color: hsl(var(--success) / 0.1);
            color: hsl(var(--success));
        }

        .badge-warning {
            background-color: hsl(var(--warning) / 0.1);
            color: hsl(var(--warning));
        }

        .badge-danger {
            background-color: hsl(var(--destructive) / 0.1);
            color: hsl(var(--destructive));
        }

        .badge-info {
            background-color: hsl(var(--info) / 0.1);
            color: hsl(var(--info));
        }

        .chart-container {
            background: hsl(var(--card));
            border: 1px solid hsl(var(--border));
            border-radius: 0.75rem;
            padding: 1.5rem;
        }

        .table-card {
            background: hsl(var(--card));
            border: 1px solid hsl(var(--border));
            border-radius: 0.75rem;
            overflow: hidden;
        }

        .alert-card {
            background: hsl(var(--card));
            border: 1px solid hsl(var(--border));
            border-radius: 0.75rem;
            padding: 1.25rem;
            transition: box-shadow 0.2s;
        }

        .alert-card:hover {
            box-shadow: 0 2px 8px rgba(0,0,0,0.06);
        }

        .health-score {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
            font-weight: 700;
        }

        .health-score-high {
            background-color: hsl(var(--success) / 0.1);
            color: hsl(var(--success));
        }

        .health-score-medium {
            background-color: hsl(var(--warning) / 0.1);
            color: hsl(var(--warning));
        }

        .health-score-low {
            background-color: hsl(var(--destructive) / 0.1);
            color: hsl(var(--destructive));
        }

        .filter-card {
            background: hsl(var(--card));
            border: 1px solid hsl(var(--border));
            border-radius: 0.75rem;
            padding: 1.5rem;
        }

        .text-success {
            color: hsl(var(--success));
        }

        .text-warning {
            color: hsl(var(--warning));
        }

        .text-danger {
            color: hsl(var(--destructive));
        }

        .text-info {
            color: hsl(var(--info));
        }

        .nav-link {
            color: hsl(var(--muted-foreground));
            padding: 0.75rem 1.5rem;
            display: block;
            text-decoration: none;
            transition: all 0.2s;
        }

        .nav-link:hover {
            background-color: hsl(var(--muted));
            color: hsl(var(--foreground));
        }

        .nav-link.active {
            background-color: hsl(var(--primary) / 0.1);
            color: hsl(var(--primary));
        }
    </style>
</head>
<body>
    <!-- Sidebar -->
    <div class="sidebar">
        <div class="px-3 mb-4">
            <h4 class="fw-bold">CRM Dashboard</h4>
        </div>
        <nav>
            <a href="static-sales-dashboard.html" class="nav-link">
                <i class="bi bi-graph-up me-2"></i> Sales
            </a>
            <a href="static-leads-dashboard.html" class="nav-link">
                <i class="bi bi-funnel me-2"></i> Leads
            </a>
            <a href="static-account-management.html" class="nav-link">
                <i class="bi bi-people me-2"></i> Account Management
            </a>
            <a href="static-support-dashboard.html" class="nav-link">
                <i class="bi bi-headset me-2"></i> Support
            </a>
            <a href="static-billing-dashboard.html" class="nav-link active">
                <i class="bi bi-cash-coin me-2"></i> Billing
            </a>
        </nav>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <!-- Header -->
        <div class="mb-4">
            <h2 class="fw-bold mb-1">Billing & Collections Dashboard</h2>
            <p class="text-muted">From revenue to refunds, one view of your cash flow & compliance</p>
        </div>

        <!-- Filters -->
        <div class="filter-card mb-4">
            <div class="d-flex align-items-center mb-3">
                <i class="bi bi-funnel me-2"></i>
                <h5 class="mb-0 fw-semibold">Filters</h5>
            </div>
            <div class="row g-3">
                <div class="col-md-3">
                    <label class="form-label small text-muted">Time Range</label>
                    <select class="form-select" id="timeRange">
                        <option value="today">Today</option>
                        <option value="week">This Week</option>
                        <option value="month" selected>This Month</option>
                        <option value="quarter">This Quarter</option>
                        <option value="year">This Year</option>
                    </select>
                </div>
                <div class="col-md-3">
                    <label class="form-label small text-muted">Customer Type</label>
                    <select class="form-select">
                        <option>All</option>
                        <option>GST Registered</option>
                        <option>Unregistered</option>
                        <option>Overseas</option>
                    </select>
                </div>
                <div class="col-md-3">
                    <label class="form-label small text-muted">Billing Type</label>
                    <select class="form-select">
                        <option>All</option>
                        <option>Prepaid</option>
                        <option>Postpaid</option>
                        <option>Enterprise</option>
                    </select>
                </div>
                <div class="col-md-3">
                    <label class="form-label small text-muted">Status</label>
                    <select class="form-select">
                        <option>All</option>
                        <option>Paid</option>
                        <option>Partially Paid</option>
                        <option>Unpaid</option>
                        <option>Overdue</option>
                    </select>
                </div>
            </div>
            <div class="d-flex justify-content-between align-items-center mt-3 pt-3 border-top">
                <span class="badge bg-secondary">5 filters active</span>
                <div>
                    <button class="btn btn-outline-secondary btn-sm me-2">Reset Filters</button>
                    <button class="btn btn-primary btn-sm">Apply Filters</button>
                </div>
            </div>
        </div>

        <!-- Global KPI Row -->
        <div class="row g-3 mb-4">
            <div class="col-lg-3 col-md-6">
                <div class="stat-card">
                    <div class="stat-label">Total Invoiced</div>
                    <div class="stat-value">₹52.8L</div>
                    <div class="small text-success mt-2">
                        <i class="bi bi-arrow-up"></i> 12.5% vs last month
                    </div>
                </div>
            </div>
            <div class="col-lg-3 col-md-6">
                <div class="stat-card">
                    <div class="stat-label">Total Collected</div>
                    <div class="stat-value">₹48.9L</div>
                    <div class="small text-muted mt-2">Collection Rate: 92.6%</div>
                </div>
            </div>
            <div class="col-lg-3 col-md-6">
                <div class="stat-card">
                    <div class="stat-label">Pending Receivables</div>
                    <div class="stat-value">₹8.2L</div>
                    <div class="small text-muted mt-2">42 customers</div>
                </div>
            </div>
            <div class="col-lg-3 col-md-6">
                <div class="stat-card">
                    <div class="stat-label">Overdue Amount</div>
                    <div class="stat-value text-danger">₹4.0L</div>
                    <div class="small text-muted mt-2">Avg 45 days overdue</div>
                </div>
            </div>
            <div class="col-lg-3 col-md-6">
                <div class="stat-card">
                    <div class="stat-label">Refunds & Credits</div>
                    <div class="stat-value">₹2.1L</div>
                    <div class="small text-muted mt-2">Refund Rate: 4.3%</div>
                </div>
            </div>
            <div class="col-lg-3 col-md-6">
                <div class="stat-card">
                    <div class="stat-label">Net Realized Revenue</div>
                    <div class="stat-value text-success">₹46.8L</div>
                    <div class="small text-success mt-2">
                        <i class="bi bi-arrow-up"></i> 10.2% vs last month
                    </div>
                </div>
            </div>
            <div class="col-lg-3 col-md-6">
                <div class="stat-card">
                    <div class="stat-label">GST Collected</div>
                    <div class="stat-value">₹9.5L</div>
                    <div class="small text-muted mt-2">18% of invoiced</div>
                </div>
            </div>
            <div class="col-lg-3 col-md-6">
                <div class="stat-card">
                    <div class="stat-label">Bad Debts Written Off</div>
                    <div class="stat-value">₹0.5L</div>
                    <div class="small text-muted mt-2">1.1% of invoiced</div>
                </div>
            </div>
        </div>

        <!-- Sales vs Collections Chart -->
        <div class="chart-container mb-4">
            <div class="d-flex justify-content-between align-items-center mb-3">
                <h5 class="fw-semibold mb-0">Sales vs Collections</h5>
                <div class="btn-group btn-group-sm">
                    <button class="btn btn-outline-secondary active">Monthly</button>
                    <button class="btn btn-outline-secondary">Quarterly</button>
                    <button class="btn btn-outline-secondary">Yearly</button>
                </div>
            </div>
            <canvas id="salesCollectionsChart" height="80"></canvas>
        </div>

        <!-- Overdue & Aging -->
        <div class="row g-4 mb-4">
            <div class="col-lg-5">
                <div class="chart-container">
                    <h5 class="fw-semibold mb-3">Overdue Aging Buckets</h5>
                    <canvas id="agingChart" height="150"></canvas>
                    <div class="row g-2 mt-3 text-center small">
                        <div class="col">
                            <div class="fw-semibold">Not Due</div>
                            <div class="text-muted">45 customers</div>
                            <div class="text-muted">68 invoices</div>
                        </div>
                        <div class="col">
                            <div class="fw-semibold">0-30 days</div>
                            <div class="text-muted">18 customers</div>
                            <div class="text-muted">32 invoices</div>
                        </div>
                        <div class="col">
                            <div class="fw-semibold">31-60 days</div>
                            <div class="text-muted">12 customers</div>
                            <div class="text-muted">21 invoices</div>
                        </div>
                        <div class="col">
                            <div class="fw-semibold">61-90 days</div>
                            <div class="text-muted">8 customers</div>
                            <div class="text-muted">15 invoices</div>
                        </div>
                        <div class="col">
                            <div class="fw-semibold">>90 days</div>
                            <div class="text-muted">14 customers</div>
                            <div class="text-muted">28 invoices</div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-7">
                <div class="chart-container">
                    <h5 class="fw-semibold mb-3">Product-wise Revenue</h5>
                    <canvas id="productRevenueChart" height="150"></canvas>
                </div>
            </div>
        </div>

        <!-- Overdue Detail Table -->
        <div class="table-card mb-4">
            <div class="p-3 border-bottom d-flex justify-content-between align-items-center">
                <h5 class="fw-semibold mb-0">Overdue Invoice Details</h5>
                <div>
                    <button class="btn btn-outline-secondary btn-sm me-2">
                        <i class="bi bi-envelope me-1"></i> Send Reminders
                    </button>
                    <button class="btn btn-outline-secondary btn-sm">
                        <i class="bi bi-download me-1"></i> Export
                    </button>
                </div>
            </div>
            <div class="table-responsive">
                <table class="table table-hover mb-0">
                    <thead class="table-light">
                        <tr>
                            <th><input type="checkbox" class="form-check-input"></th>
                            <th>Customer</th>
                            <th>Type</th>
                            <th>Country</th>
                            <th>Invoice No.</th>
                            <th>Invoice Date</th>
                            <th>Due Date</th>
                            <th class="text-end">Amount</th>
                            <th class="text-end">Paid</th>
                            <th class="text-end">Outstanding</th>
                            <th class="text-end">Days Overdue</th>
                            <th>Status</th>
                            <th>Owner</th>
                        </tr>
                    </thead>
                    <tbody id="overdueTableBody">
                        <!-- Populated by JS -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Refund Analytics -->
        <div class="row g-4 mb-4">
            <div class="col-lg-7">
                <div class="chart-container">
                    <h5 class="fw-semibold mb-3">Refund Trends & Analysis</h5>
                    <canvas id="refundChart" height="100"></canvas>
                </div>
            </div>
            <div class="col-lg-5">
                <div class="chart-container">
                    <h5 class="fw-semibold mb-3">Refund Reasons Breakdown</h5>
                    <canvas id="refundReasonsChart" height="100"></canvas>
                </div>
            </div>
        </div>

        <!-- GST Treatment View -->
        <div class="mb-4">
            <h5 class="fw-semibold mb-3">GST & Tax Treatment</h5>
            <div class="row g-3 mb-3">
                <div class="col-md-4">
                    <div class="stat-card">
                        <div class="stat-label">GST Registered (B2B)</div>
                        <div class="stat-value">₹32.5L</div>
                        <div class="small text-muted mt-2">156 invoices • GST: ₹5.85L</div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="stat-card">
                        <div class="stat-label">Unregistered (B2C)</div>
                        <div class="stat-value">₹12.8L</div>
                        <div class="small text-muted mt-2">89 invoices • GST: ₹2.3L</div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="stat-card">
                        <div class="stat-label">Overseas (Export)</div>
                        <div class="stat-value">₹7.5L</div>
                        <div class="small text-muted mt-2">34 invoices • GST: ₹0</div>
                    </div>
                </div>
            </div>
            <div class="table-card">
                <div class="p-3 border-bottom d-flex justify-content-between align-items-center">
                    <h6 class="fw-semibold mb-0">GST Breakdown by Invoice</h6>
                    <button class="btn btn-outline-secondary btn-sm">
                        <i class="bi bi-download me-1"></i> Export GSTR Report
                    </button>
                </div>
                <div class="table-responsive">
                    <table class="table table-sm mb-0">
                        <thead class="table-light">
                            <tr>
                                <th>Invoice No.</th>
                                <th>Customer</th>
                                <th>Type</th>
                                <th>Place of Supply</th>
                                <th class="text-end">Taxable Value</th>
                                <th class="text-end">CGST</th>
                                <th class="text-end">SGST</th>
                                <th class="text-end">IGST</th>
                                <th>Category</th>
                            </tr>
                        </thead>
                        <tbody id="gstTableBody">
                            <!-- Populated by JS -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Customer Billing Health -->
        <div class="mb-4">
            <h5 class="fw-semibold mb-3">Customer Billing Health & Risk</h5>
            
            <!-- High Risk Alert -->
            <div class="alert alert-danger d-flex align-items-start mb-3">
                <i class="bi bi-exclamation-triangle-fill me-3 fs-4"></i>
                <div class="flex-grow-1">
                    <h6 class="fw-semibold mb-2">High Risk Customers (2)</h6>
                    <div class="row g-2">
                        <div class="col-md-6">
                            <div class="bg-white p-3 rounded">
                                <div class="d-flex justify-content-between align-items-start">
                                    <div>
                                        <div class="fw-semibold">StartupHub</div>
                                        <div class="small text-muted">5 overdues • 4 refund requests</div>
                                    </div>
                                    <div class="text-end">
                                        <div class="small text-muted">Avg Delay</div>
                                        <div class="fw-bold text-danger">52 days</div>
                                    </div>
                                </div>
                                <button class="btn btn-outline-primary btn-sm mt-2 w-100">Review</button>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="bg-white p-3 rounded">
                                <div class="d-flex justify-content-between align-items-start">
                                    <div>
                                        <div class="fw-semibold">InnovateTech Ltd</div>
                                        <div class="small text-muted">6 overdues • 3 refund requests</div>
                                    </div>
                                    <div class="text-end">
                                        <div class="small text-muted">Avg Delay</div>
                                        <div class="fw-bold text-danger">67 days</div>
                                    </div>
                                </div>
                                <button class="btn btn-outline-primary btn-sm mt-2 w-100">Review</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Health Scorecard Table -->
            <div class="table-card">
                <div class="p-3 border-bottom d-flex justify-content-between align-items-center">
                    <h6 class="fw-semibold mb-0">Customer Billing Health Scorecard</h6>
                    <button class="btn btn-outline-secondary btn-sm">
                        <i class="bi bi-download me-1"></i> Export
                    </button>
                </div>
                <div class="table-responsive">
                    <table class="table table-hover mb-0">
                        <thead class="table-light">
                            <tr>
                                <th>Customer</th>
                                <th class="text-end">MRR / Avg Invoice</th>
                                <th class="text-center">Health Score</th>
                                <th class="text-end">Avg Payment Delay</th>
                                <th class="text-center">Total Overdues</th>
                                <th class="text-center">Refund Count</th>
                                <th>Risk Level</th>
                            </tr>
                        </thead>
                        <tbody id="healthTableBody">
                            <!-- Populated by JS -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Team Performance -->
        <div class="table-card mb-4">
            <div class="p-3 border-bottom d-flex justify-content-between align-items-center">
                <h5 class="fw-semibold mb-0">Team Performance & Accountability</h5>
                <button class="btn btn-outline-secondary btn-sm">
                    <i class="bi bi-download me-1"></i> Export
                </button>
            </div>
            <div class="table-responsive">
                <table class="table table-hover mb-0">
                    <thead class="table-light">
                        <tr>
                            <th>Team Member</th>
                            <th class="text-center">Invoices Generated</th>
                            <th class="text-end">Invoice Amount</th>
                            <th class="text-end">Collections</th>
                            <th class="text-center">Reminders Sent</th>
                            <th class="text-center">Refunds Processed</th>
                            <th class="text-center">Error Incidents</th>
                            <th class="text-end">Avg Invoice Time</th>
                            <th class="text-end">Avg Payment Time</th>
                        </tr>
                    </thead>
                    <tbody id="teamTableBody">
                        <!-- Populated by JS -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Alerts & Exceptions -->
        <div class="mb-4">
            <h5 class="fw-semibold mb-3">Alerts & Exception Watchlist</h5>
            <div class="row g-3" id="alertsContainer">
                <!-- Populated by JS -->
            </div>
        </div>
    </div>

    <script>
        // Mock Data
        const overdueData = [
            { customer: "TechCorp Solutions", type: "GST Registered", country: "India", invoice: "INV-2024-1234", invoiceDate: "2024-09-15", dueDate: "2024-10-15", amount: 285000, paid: 0, outstanding: 285000, daysOverdue: 77, status: "Not Paid", owner: "Rahul Sharma" },
            { customer: "CloudStart Inc", type: "Overseas", country: "USA", invoice: "INV-2024-1156", invoiceDate: "2024-10-01", dueDate: "2024-11-01", amount: 156000, paid: 50000, outstanding: 106000, daysOverdue: 61, status: "Part Paid", owner: "Priya Patel" },
            { customer: "DataHub Systems", type: "GST Registered", country: "India", invoice: "INV-2024-1267", invoiceDate: "2024-10-10", dueDate: "2024-11-10", amount: 325000, paid: 0, outstanding: 325000, daysOverdue: 52, status: "In Collection", owner: "Amit Kumar" },
            { customer: "WebScale Ltd", type: "Unregistered", country: "India", invoice: "INV-2024-1289", invoiceDate: "2024-10-20", dueDate: "2024-11-20", amount: 89000, paid: 0, outstanding: 89000, daysOverdue: 42, status: "Not Paid", owner: "Neha Singh" },
            { customer: "InnovateTech", type: "GST Registered", country: "India", invoice: "INV-2024-1301", invoiceDate: "2024-11-01", dueDate: "2024-12-01", amount: 412000, paid: 200000, outstanding: 212000, daysOverdue: 31, status: "Part Paid", owner: "Vikram Reddy" }
        ];

        const gstData = [
            { invoice: "INV-2024-1234", customer: "TechCorp Solutions", type: "GST Registered", place: "Maharashtra", taxable: 241525, cgst: 21737, sgst: 21737, igst: 0, category: "B2B" },
            { invoice: "INV-2024-1156", customer: "CloudStart Inc", type: "Overseas", place: "USA", taxable: 156000, cgst: 0, sgst: 0, igst: 0, category: "Export" },
            { invoice: "INV-2024-1267", customer: "DataHub Systems", type: "GST Registered", place: "Karnataka", taxable: 275424, cgst: 0, sgst: 0, igst: 49576, category: "B2B" },
            { invoice: "INV-2024-1289", customer: "WebScale Ltd", type: "Unregistered", place: "Delhi", taxable: 75424, cgst: 6788, sgst: 6788, igst: 0, category: "B2C" }
        ];

        const healthData = [
            { name: "TechVision Pvt Ltd", mrr: 95000, healthScore: 92, avgDelay: 3, overdues: 0, refunds: 0, risk: "Low" },
            { name: "CloudWorks Solutions", mrr: 125000, healthScore: 88, avgDelay: 7, overdues: 1, refunds: 1, risk: "Low" },
            { name: "DataCore Systems", mrr: 85000, healthScore: 65, avgDelay: 28, overdues: 3, refunds: 2, risk: "Medium" },
            { name: "StartupHub", mrr: 35000, healthScore: 45, avgDelay: 52, overdues: 5, refunds: 4, risk: "High" },
            { name: "WebScale Pro", mrr: 65000, healthScore: 78, avgDelay: 12, overdues: 2, refunds: 1, risk: "Low" },
            { name: "InnovateTech Ltd", mrr: 145000, healthScore: 38, avgDelay: 67, overdues: 6, refunds: 3, risk: "High" }
        ];

        const teamData = [
            { name: "Anita Desai", invoices: 142, amount: 12500000, collections: 11200000, reminders: 245, refunds: 12, errors: 2, invoiceTime: 1.2, paymentTime: 2.8 },
            { name: "Rahul Verma", invoices: 128, amount: 10800000, collections: 9500000, reminders: 198, refunds: 8, errors: 1, invoiceTime: 1.5, paymentTime: 3.2 },
            { name: "Priya Gupta", invoices: 156, amount: 14200000, collections: 12800000, reminders: 287, refunds: 15, errors: 3, invoiceTime: 1.1, paymentTime: 2.5 },
            { name: "Amit Shah", invoices: 134, amount: 11600000, collections: 10200000, reminders: 223, refunds: 10, errors: 2, invoiceTime: 1.4, paymentTime: 3.0 }
        ];

        const alerts = [
            { severity: "High", title: "Large Overdue Amount - InnovateTech Ltd", description: "Outstanding amount of ₹4.12L overdue by 67 days. Customer has repeated payment delays.", action: "Escalate to Sales", icon: "exclamation-circle" },
            { severity: "High", title: "Very Old Outstanding - TechCorp Solutions", description: "Invoice INV-2024-1234 is 90+ days overdue. Amount: ₹2.85L", action: "Contact CA / Legal", icon: "exclamation-circle" },
            { severity: "Medium", title: "High Refund Account - DataCore Systems", description: "Customer has requested 4 refunds in the last 3 months totaling ₹1.2L.", action: "Flag to Support", icon: "exclamation-triangle" },
            { severity: "Medium", title: "GST GSTIN Missing - WebScale Pro", description: "Account marked as GST Registered but GSTIN details not on file.", action: "Request GSTIN", icon: "exclamation-triangle" },
            { severity: "Low", title: "Negative Balance - CloudStart Inc", description: "Customer account shows negative balance of ₹15K due to double payment.", action: "Process Refund", icon: "info-circle" },
            { severity: "High", title: "Collection Issue - Multiple Accounts", description: "8 invoices from different customers have crossed 60-day overdue mark this week.", action: "Bulk Follow-up", icon: "exclamation-circle" }
        ];

        // Format currency
        function formatCurrency(value) {
            if (value >= 100000) {
                return '₹' + (value / 100000).toFixed(1) + 'L';
            } else if (value >= 1000) {
                return '₹' + (value / 1000).toFixed(0) + 'K';
            }
            return '₹' + value;
        }

        // Populate Overdue Table
        const overdueTableBody = document.getElementById('overdueTableBody');
        overdueData.forEach(item => {
            const statusClass = item.status === "Not Paid" ? "danger" : item.status === "Part Paid" ? "warning" : "secondary";
            const daysClass = item.daysOverdue > 60 ? "text-danger" : item.daysOverdue > 30 ? "text-warning" : "";
            
            overdueTableBody.innerHTML += `
                <tr>
                    <td><input type="checkbox" class="form-check-input"></td>
                    <td class="fw-medium">${item.customer}</td>
                    <td><span class="badge bg-light text-dark border">${item.type}</span></td>
                    <td>${item.country}</td>
                    <td><code class="small">${item.invoice}</code></td>
                    <td>${item.invoiceDate}</td>
                    <td>${item.dueDate}</td>
                    <td class="text-end fw-medium">${formatCurrency(item.amount)}</td>
                    <td class="text-end text-success">${formatCurrency(item.paid)}</td>
                    <td class="text-end fw-semibold">${formatCurrency(item.outstanding)}</td>
                    <td class="text-end fw-bold ${daysClass}">${item.daysOverdue}</td>
                    <td><span class="badge badge-${statusClass}">${item.status}</span></td>
                    <td class="small text-muted">${item.owner}</td>
                </tr>
            `;
        });

        // Populate GST Table
        const gstTableBody = document.getElementById('gstTableBody');
        gstData.forEach(item => {
            gstTableBody.innerHTML += `
                <tr>
                    <td><code class="small">${item.invoice}</code></td>
                    <td>${item.customer}</td>
                    <td><span class="badge bg-light text-dark border">${item.type}</span></td>
                    <td>${item.place}</td>
                    <td class="text-end">${formatCurrency(item.taxable)}</td>
                    <td class="text-end">${item.cgst > 0 ? formatCurrency(item.cgst) : '-'}</td>
                    <td class="text-end">${item.sgst > 0 ? formatCurrency(item.sgst) : '-'}</td>
                    <td class="text-end">${item.igst > 0 ? formatCurrency(item.igst) : '-'}</td>
                    <td><span class="badge bg-primary">${item.category}</span></td>
                </tr>
            `;
        });

        // Populate Health Table
        const healthTableBody = document.getElementById('healthTableBody');
        healthData.forEach(item => {
            const scoreClass = item.healthScore >= 80 ? "high" : item.healthScore >= 60 ? "medium" : "low";
            const delayClass = item.avgDelay > 30 ? "text-danger" : item.avgDelay > 14 ? "text-warning" : "";
            const riskBadge = item.risk === "Low" ? "badge-success" : item.risk === "Medium" ? "badge-warning" : "badge-danger";
            
            healthTableBody.innerHTML += `
                <tr>
                    <td class="fw-medium">${item.name}</td>
                    <td class="text-end fw-semibold">${formatCurrency(item.mrr)}</td>
                    <td class="text-center">
                        <div class="d-flex justify-content-center">
                            <div class="health-score health-score-${scoreClass}">${item.healthScore}</div>
                        </div>
                    </td>
                    <td class="text-end ${delayClass} fw-semibold">${item.avgDelay} days</td>
                    <td class="text-center">
                        <span class="badge ${item.overdues > 3 ? 'badge-danger' : 'bg-secondary'}">${item.overdues}</span>
                    </td>
                    <td class="text-center">
                        <span class="badge ${item.refunds > 2 ? 'badge-danger' : 'bg-secondary'}">${item.refunds}</span>
                    </td>
                    <td><span class="badge ${riskBadge}">${item.risk}</span></td>
                </tr>
            `;
        });

        // Populate Team Table
        const teamTableBody = document.getElementById('teamTableBody');
        teamData.forEach(item => {
            const errorBadge = item.errors > 2 ? "badge-danger" : "bg-secondary";
            const invoiceTimeClass = item.invoiceTime > 1.5 ? "text-warning" : "";
            const paymentTimeClass = item.paymentTime > 3 ? "text-warning" : "";
            
            teamTableBody.innerHTML += `
                <tr>
                    <td class="fw-medium">${item.name}</td>
                    <td class="text-center"><span class="badge bg-secondary">${item.invoices}</span></td>
                    <td class="text-end fw-semibold">${formatCurrency(item.amount)}</td>
                    <td class="text-end fw-semibold text-success">${formatCurrency(item.collections)}</td>
                    <td class="text-center text-muted">${item.reminders}</td>
                    <td class="text-center"><span class="badge bg-light text-dark border">${item.refunds}</span></td>
                    <td class="text-center"><span class="badge ${errorBadge}">${item.errors}</span></td>
                    <td class="text-end ${invoiceTimeClass}">${item.invoiceTime} days</td>
                    <td class="text-end ${paymentTimeClass}">${item.paymentTime} days</td>
                </tr>
            `;
        });

        // Populate Alerts
        const alertsContainer = document.getElementById('alertsContainer');
        alerts.forEach(alert => {
            const severityColor = alert.severity === "High" ? "danger" : alert.severity === "Medium" ? "warning" : "info";
            const iconColor = alert.severity === "High" ? "text-danger" : alert.severity === "Medium" ? "text-warning" : "text-info";
            
            alertsContainer.innerHTML += `
                <div class="col-lg-6">
                    <div class="alert-card">
                        <div class="d-flex align-items-start gap-3">
                            <i class="bi bi-${alert.icon} fs-5 ${iconColor}"></i>
                            <div class="flex-grow-1">
                                <span class="badge badge-${severityColor} mb-2">${alert.severity}</span>
                                <h6 class="fw-semibold mb-2">${alert.title}</h6>
                                <p class="text-muted small mb-3">${alert.description}</p>
                                <div class="d-flex gap-2">
                                    <button class="btn btn-${alert.severity === 'High' ? 'primary' : 'outline-primary'} btn-sm">
                                        ${alert.action}
                                    </button>
                                    <button class="btn btn-outline-secondary btn-sm">Dismiss</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        });

        // Sales vs Collections Chart
        const salesCollectionsCtx = document.getElementById('salesCollectionsChart').getContext('2d');
        new Chart(salesCollectionsCtx, {
            type: 'line',
            data: {
                labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
                datasets: [
                    {
                        label: 'Invoiced Amount',
                        data: [38, 42, 39, 45, 41, 48, 43, 46, 44, 47, 45, 45.2],
                        borderColor: 'rgb(59, 130, 246)',
                        backgroundColor: 'rgba(59, 130, 246, 0.1)',
                        fill: true,
                        tension: 0.4
                    },
                    {
                        label: 'Collected Amount',
                        data: [34, 39, 35, 41, 37, 43, 38, 42, 40, 43, 41, 38.9],
                        borderColor: 'rgb(34, 197, 94)',
                        backgroundColor: 'rgba(34, 197, 94, 0.1)',
                        fill: true,
                        tension: 0.4
                    },
                    {
                        label: 'Pending',
                        data: [4, 3, 4, 4, 4, 5, 5, 4, 4, 4, 4, 6.3],
                        borderColor: 'rgb(251, 146, 60)',
                        backgroundColor: 'rgba(251, 146, 60, 0.1)',
                        fill: true,
                        tension: 0.4
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: true,
                plugins: {
                    legend: {
                        position: 'bottom'
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        ticks: {
                            callback: function(value) {
                                return '₹' + value + 'L';
                            }
                        }
                    }
                }
            }
        });

        // Aging Chart
        const agingCtx = document.getElementById('agingChart').getContext('2d');
        new Chart(agingCtx, {
            type: 'bar',
            data: {
                labels: ['Not Due', '0-30 days', '31-60 days', '61-90 days', '>90 days'],
                datasets: [{
                    label: 'Amount',
                    data: [12, 8, 6, 4, 10],
                    backgroundColor: [
                        'rgba(34, 197, 94, 0.8)',
                        'rgba(59, 130, 246, 0.8)',
                        'rgba(251, 146, 60, 0.8)',
                        'rgba(239, 68, 68, 0.8)',
                        'rgba(239, 68, 68, 0.8)'
                    ],
                    borderRadius: 8
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: true,
                plugins: {
                    legend: {
                        display: false
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        ticks: {
                            callback: function(value) {
                                return '₹' + value + 'L';
                            }
                        }
                    }
                }
            }
        });

        // Product Revenue Chart
        const productRevenueCtx = document.getElementById('productRevenueChart').getContext('2d');
        new Chart(productRevenueCtx, {
            type: 'bar',
            data: {
                labels: ['VMs', 'Kubernetes', 'Object Storage', 'Databases', 'Load Balancers', 'DR/Backup'],
                datasets: [{
                    label: 'Revenue',
                    data: [18.5, 12.3, 8.7, 6.4, 4.2, 2.7],
                    backgroundColor: 'rgba(59, 130, 246, 0.8)',
                    borderRadius: 8
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: true,
                plugins: {
                    legend: {
                        display: false
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        ticks: {
                            callback: function(value) {
                                return '₹' + value + 'L';
                            }
                        }
                    }
                }
            }
        });

        // Refund Chart
        const refundCtx = document.getElementById('refundChart').getContext('2d');
        new Chart(refundCtx, {
            type: 'line',
            data: {
                labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
                datasets: [{
                    label: 'Refund Amount',
                    data: [1.2, 0.8, 1.5, 2.1, 1.8, 2.4, 1.9, 2.2, 1.6, 2.0, 1.7, 2.1],
                    borderColor: 'rgb(239, 68, 68)',
                    backgroundColor: 'rgba(239, 68, 68, 0.1)',
                    fill: true,
                    tension: 0.4
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: true,
                plugins: {
                    legend: {
                        display: false
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        ticks: {
                            callback: function(value) {
                                return '₹' + value + 'L';
                            }
                        }
                    }
                }
            }
        });

        // Refund Reasons Chart
        const refundReasonsCtx = document.getElementById('refundReasonsChart').getContext('2d');
        new Chart(refundReasonsCtx, {
            type: 'doughnut',
            data: {
                labels: ['Overbilling', 'Service Issues', 'Trial Cancellation', 'Double Payment', 'Other'],
                datasets: [{
                    data: [35, 28, 18, 12, 7],
                    backgroundColor: [
                        'rgba(239, 68, 68, 0.8)',
                        'rgba(251, 146, 60, 0.8)',
                        'rgba(59, 130, 246, 0.8)',
                        'rgba(168, 85, 247, 0.8)',
                        'rgba(156, 163, 175, 0.8)'
                    ]
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: true,
                plugins: {
                    legend: {
                        position: 'bottom'
                    }
                }
            }
        });
    </script>
</body>
</html>